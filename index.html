<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TOC TOC TOC - MongBeach Oficial</title>
    <style>
        :root { --primary: #00796b; --child: #00bcd4; --bg: #f4f7f6; --alert: #d32f2f; --report: #ff9800; --admin: #263238; }
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); margin: 0; display: flex; justify-content: center; }
        .container { width: 100%; max-width: 500px; background: #fff; padding: 25px; border-radius: 20px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); margin: 20px; text-align: center; min-height: 90vh; display: flex; flex-direction: column; }
        .conteudo { flex-grow: 1; }
        .tela { display: none; animation: fadeIn 0.3s; }
        .ativa { display: block; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        h2 { color: var(--primary); font-size: 1.1rem; text-transform: uppercase; margin-bottom: 15px; }
        label { display: block; text-align: left; font-size: 11px; font-weight: bold; color: #666; margin-top: 10px; }
        input, select { width: 100%; padding: 12px; margin: 4px 0; border: 1px solid #ccc; border-radius: 10px; box-sizing: border-box; }
        button { width: 100%; padding: 15px; border: none; border-radius: 12px; cursor: pointer; font-weight: bold; text-transform: uppercase; margin-top: 10px; }
        .btn-resp { background: var(--primary); color: white; }
        .btn-prof { background: #546e7a; color: white; }
        .btn-child { background: var(--child); color: white; border: 2px solid #fff; box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
        .btn-admin { background: var(--admin); color: white; font-size: 10px; opacity: 0.5; margin-top: 30px; }
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-top: 15px; }
        .btn-card { border: 2px solid #eee; border-radius: 18px; padding: 10px; cursor: pointer; background: #fff; transition: 0.2s; }
        .btn-card img { width: 75px; height: 75px; object-fit: contain; }
        .btn-card p { font-size: 10px; font-weight: bold; margin-top: 5px; color: #555; text-transform: uppercase; }
        .card-relatorio { background: #f9f9f9; padding: 15px; border-radius: 12px; border-left: 8px solid var(--primary); margin-bottom: 12px; text-align: left; font-size: 13px; }
        .footer { margin-top: 30px; font-size: 11px; color: #888; border-top: 1px solid #eee; padding-top: 15px; line-height: 1.6; }
        table { width: 100%; border-collapse: collapse; font-size: 11px; margin-top: 10px; }
        th, td { border: 1px solid #ddd; padding: 6px; text-align: left; }
    </style>
</head>
<body>

<div class="container">
    <div class="conteudo">
        <div id="menu" class="tela ativa">
            <h2 style="letter-spacing: 4px;">TOC TOC TOC</h2>
            <div class="menu-inicial">
                <button class="btn-resp" onclick="ir('cadastro_pai')">Cadastro Responsável</button>
                <button class="btn-prof" onclick="ir('cadastro_prof')">Cadastro Profissional</button>
                <button class="btn-resp" style="background:var(--report)" onclick="ir('login_pais')">Acesso dos Pais</button>
                <button class="btn-prof" style="background:#37474f" onclick="ir('login_prof')">Painel do Professor</button>
                <button class="btn-admin" onclick="ir('login_admin')">Administração / Gestor</button>
            </div>
        </div>

        <div id="cadastro_pai" class="tela">
            <h2>Novo Responsável</h2>
            <input type="text" id="p_nome" placeholder="Seu Nome">
            <input type="text" id="p_cpf" placeholder="Seu CPF">
            <input type="text" id="c_nome" placeholder="Nome da Criança">
            <input type="text" id="codigo_vinc" placeholder="Código da Turma (Ex: MONG-01)">
            <input type="password" id="p_senha" placeholder="Crie sua Senha">
            <button class="btn-resp" onclick="salvarPai()">Salvar Cadastro</button>
            <button onclick="ir('menu')">Voltar</button>
        </div>

        <div id="cadastro_prof" class="tela">
            <h2>Novo Profissional</h2>
            <input type="text" id="prof_nome" placeholder="Nome Completo">
            <input type="text" id="prof_id_vinc" placeholder="Código da Turma">
            <input type="password" id="prof_senha" placeholder="Crie sua Senha">
            <button class="btn-prof" onclick="salvarProf()">Cadastrar Professor</button>
            <button onclick="ir('menu')">Voltar</button>
        </div>

        <div id="login_pais" class="tela">
            <h2>Acesso Responsável</h2>
            <input type="text" id="l_pai_cpf" placeholder="CPF">
            <input type="password" id="l_pai_senha" placeholder="Senha">
            <button class="btn-resp" onclick="logarPai()">Entrar</button>
            <button onclick="ir('menu')">Voltar</button>
        </div>

        <div id="painel_pais" class="tela">
            <h2 id="boas_vindas_pai">Olá</h2>
            <button class="btn-child" onclick="ir('humor_inicial')">ENTREGAR PARA CRIANÇA</button>
            <h3 style="font-size:13px; margin-top:20px; color:var(--primary)">RELATÓRIO UNIFICADO</h3>
            <div id="historico_integrado" style="max-height: 300px; overflow-y: auto;"></div>
            <button class="btn-resp" onclick="ir('menu')" style="margin-top:20px;">Sair</button>
        </div>

        <div id="login_prof" class="tela">
            <h2>Login Professor</h2>
            <input type="text" id="l_prof_nome" placeholder="Nome Cadastrado">
            <input type="password" id="l_prof_senha" placeholder="Senha">
            <button class="btn-prof" onclick="logarProf()">Entrar</button>
            <button onclick="ir('menu')">Voltar</button>
        </div>

        <div id="painel_prof" class="tela">
            <h2>Turma: <span id="id_turma_display"></span></h2>
            <div id="lista_alunos_vinculados"></div>
            <button class="btn-prof" onclick="ir('menu')" style="margin-top:20px;">Sair</button>
        </div>

        <div id="tela_obs_prof" class="tela">
            <h2 id="nome_aluno_obs">Diário Técnico</h2>
            <div style="overflow-y: auto; max-height: 350px; text-align: left; padding: 5px;">
                <label>Contato Visual:</label>
                <select id="o_visual"><option>Normal</option><option>Fugaz</option><option>Inexistente</option></select>
                <label>Interação no Recreio:</label>
                <select id="o_isolamento"><option>Brincou em grupo</option><option>Isolado</option><option>Não observado</option></select>
                <label>Foco / Hiperfoco:</label>
                <select id="o_foco"><option>Normal</option><option>Excessivo em um tema</option></select>
                <label>Estereotipias:</label>
                <select id="o_movimento"><option>Nenhuma</option><option>Sim (Mãos/Corpo)</option></select>
                <label>Linguagem:</label>
                <select id="o_fala"><option>Funcional</option><option>Ecolalia (Repetição)</option><option>Não verbal</option></select>
                <label>Sensorial:</label>
                <select id="o_sensorial"><option>Normal</option><option>Incomodado com som/luz</option></select>
            </div>
            <button class="btn-prof" onclick="salvarObsTecnica()">Enviar Observação</button>
        </div>

        <div id="humor_inicial" class="tela">
            <h2>Como o Tatu está?</h2>
            <div class="grid">
                <div class="btn-card" onclick="setHumor('FELIZ')"><img src="tatu_feliz.png"><p>FELIZ</p></div>
                <div class="btn-card" onclick="setHumor('TRISTE')"><img src="tatu_triste.png"><p>TRISTE</p></div>
                <div class="btn-card" onclick="setHumor('NORMAL')"><img src="tatu_neutro.png"><p>NORMAL</p></div>
                <div class="btn-card" onclick="setHumor('ISOLADO')"><img src="tatu_enrolado.png"><p>ISOLADO</p></div>
            </div>
        </div>

        <div id="motivo_feliz" class="tela">
            <h2>O que alegrou o Tatu?</h2>
            <div class="grid">
                <div class="btn-card" onclick="finalizarCriança('Brincou muito no Pátio')"><img src="patio.png"><p>PÁTIO</p></div>
                <div class="btn-card" onclick="finalizarCriança('Ganhou um elogio legal')"><img src="tatu_feliz.png"><p>ELOGIO</p></div>
                <div class="btn-card" onclick="finalizarCriança('Lanche estava uma delícia')"><img src="tatu_feliz.png"><p>COMIDA</p></div>
            </div>
        </div>

        <div id="motivo_triste" class="tela">
            <h2>O que houve com o Tatu?</h2>
            <div class="grid">
                <div class="btn-card" onclick="setOcorrencia('FICOU DE CASTIGO', 'tela_castigo')"><img src="castigo.png"><p>CASTIGO</p></div>
                <div class="btn-card" onclick="setOcorrencia('RIRAM DE MIM', 'tela_agentes')"><img src="grupo_bullying.png"><p>BULLYING</p></div>
                <div class="btn-card" onclick="setOcorrencia('FOI AGREDIDO', 'tela_agentes')"><img src="sensacao_raio.png"><p>MACHUCARAM</p></div>
            </div>
        </div>

        <div id="tela_castigo" class="tela">
            <h2>Onde foi o castigo?</h2>
            <div class="grid">
                <div class="btn-card" onclick="setOcorrencia('NA PORTA', 'tela_porta')"><img src="fora_sala.png"><p>NA PORTA</p></div>
                <div class="btn-card" onclick="setOcorrencia('EM FRENTE À TURMA', 'tela_corpo')"><img src="frente_alunos.png"><p>NA FRENTE</p></div>
            </div>
        </div>

        <div id="tela_porta" class="tela">
            <h2>E a porta estava?</h2>
            <div class="grid">
                <div class="btn-card" onclick="finalizarCriança('Castigo na porta ABERTA')"><img src="porta_aberta.png"><p>ABERTA</p></div>
                <div class="btn-card" onclick="finalizarCriança('Castigo na porta FECHADA')"><img src="porta_fechada.png"><p>FECHADA</p></div>
            </div>
        </div>

        <div id="tela_agentes" class="tela">
            <h2>Quem estava lá?</h2>
            <div class="grid">
                <div class="btn-card" onclick="setAgente('Professora')"><img src="professora.png"><p>PROFESSORA</p></div>
                <div class="btn-card" onclick="setAgente('Colegas')"><img src="grupo_unido.png"><p>COLEGAS</p></div>
                <div class="btn-card" onclick="setAgente('Não conheço')"><img src="nao_conheco.png"><p>NÃO CONHEÇO</p></div>
                <div class="btn-card" onclick="setAgente('Sigilo')"><img src="opcao_sigilo.png"><p>SIGILO</p></div>
            </div>
        </div>

        <div id="tela_corpo" class="tela">
            <h2>O que sentiu no corpo?</h2>
            <div class="grid">
                <div class="btn-card" onclick="finalizarCriança('Nó na garganta')"><img src="sensacao_no.png"><p>NÓ</p></div>
                <div class="btn-card" onclick="finalizarCriança('Raiva / Calor')"><img src="sensacao_raio.png"><p>RAIVA</p></div>
                <div class="btn-card" onclick="finalizarCriança('Vontade de chorar')"><img src="sensacao_lagrimas.png"><p>CHORO</p></div>
            </div>
        </div>

        <div id="login_admin" class="tela">
            <h2>Painel do Gestor</h2>
            <input type="password" id="admin_key" placeholder="Senha Mestra">
            <button class="btn-resp" onclick="acessarAdmin()">Entrar no Painel</button>
            <button onclick="ir('menu')">Voltar</button>
        </div>

        <div id="painel_admin" class="tela">
            <h2>Relatório Geral de Vínculos</h2>
            <table id="tabela_admin">
                <thead><tr><th>Tipo</th><th>Nome</th><th>Código</th></tr></thead>
                <tbody id="tabela_admin_body"></tbody>
            </table>
            <button class="btn-resp" onclick="ir('menu')" style="margin-top:20px;">Sair</button>
        </div>

    </div>

    <div class="footer">
        Desenvolvido por <strong>MongBeach</strong> | Alessandro Bortoleto Rodrigues<br>
        CPF: 259.906.398-13 | alebortoleto@gmail.com<br>
        (13) 99175-3601 | (11) 97446-5550<br>
        Instagram: @mong.beach
    </div>
</div>

<script>
    let userLogado = null;
    let alunoSelecionado = null;
    let relatoCriança = { humor: '', ocorrencia: '', detalhe: '' };

    function ir(id) {
        document.querySelectorAll('.tela').forEach(t => t.classList.remove('ativa'));
        document.getElementById(id).classList.add('ativa');
        window.scrollTo(0,0);
    }

    function salvarPai() {
        let pais = JSON.parse(localStorage.getItem('tt_pais')) || [];
        pais.push({
            nome: document.getElementById('p_nome').value,
            cpf: document.getElementById('p_cpf').value,
            crianca: document.getElementById('c_nome').value,
            codigoVinc: document.getElementById('codigo_vinc').value,
            senha: document.getElementById('p_senha').value
        });
        localStorage.setItem('tt_pais', JSON.stringify(pais));
        alert("Pai cadastrado!"); ir('menu');
    }

    function salvarProf() {
        let profs = JSON.parse(localStorage.getItem('tt_profs')) || [];
        profs.push({
            nome: document.getElementById('prof_nome').value,
            codigoVinc: document.getElementById('prof_id_vinc').value,
            senha: document.getElementById('prof_senha').value
        });
        localStorage.setItem('tt_profs', JSON.stringify(profs));
        alert("Professor cadastrado!"); ir('menu');
    }

    function logarPai() {
        let pais = JSON.parse(localStorage.getItem('tt_pais')) || [];
        userLogado = pais.find(x => x.cpf === document.getElementById('l_pai_cpf').value && x.senha === document.getElementById('l_pai_senha').value);
        if(userLogado) {
            document.getElementById('boas_vindas_pai').innerText = "Responsável: " + userLogado.nome;
            mostrarRelatorioIntegrado();
            ir('painel_pais');
        } else alert("Erro!");
    }

    function logarProf() {
        let profs = JSON.parse(localStorage.getItem('tt_profs')) || [];
        userLogado = profs.find(x => x.nome === document.getElementById('l_prof_nome').value && x.senha === document.getElementById('l_prof_senha').value);
        if(userLogado) {
            document.getElementById('id_turma_display').innerText = userLogado.codigoVinc;
            listarAlunos();
            ir('painel_prof');
        } else alert("Erro!");
    }

    function listarAlunos() {
        let pais = JSON.parse(localStorage.getItem('tt_pais')) || [];
        let meusAlunos = pais.filter(p => p.codigoVinc === userLogado.codigoVinc);
        document.getElementById('lista_alunos_vinculados').innerHTML = meusAlunos.map(a => `
            <div style="background:#f4f4f4; padding:10px; margin:5px; border-radius:10px;">
                <strong>${a.crianca}</strong><br>
                <button onclick="abrirObs('${a.crianca}', '${a.cpf}')" style="background:var(--primary); color:white; padding:5px; font-size:10px;">Observar</button>
            </div>
        `).join('') || "Sem alunos.";
    }

    function abrirObs(nome, paiCpf) {
        alunoSelecionado = { nome: nome, paiCpf: paiCpf };
        document.getElementById('nome_aluno_obs').innerText = "Aluno: " + nome;
        ir('tela_obs_prof');
    }

    function salvarObsTecnica() {
        let obs = JSON.parse(localStorage.getItem('tt_obs')) || [];
        obs.push({
            paiCpf: alunoSelecionado.paiCpf, // Chave de vínculo para o pai ver
            prof: userLogado.nome,
            data: new Date().toLocaleString(),
            tipo: 'PROFISSIONAL',
            visual: document.getElementById('o_visual').value,
            isolamento: document.getElementById('o_isolamento').value,
            fala: document.getElementById('o_fala').value,
            foco: document.getElementById('o_foco').value
        });
        localStorage.setItem('tt_obs', JSON.stringify(obs));
        alert("Enviado!"); ir('painel_prof');
    }

    function setHumor(h) { 
        relatoCriança = { humor: h, ocorrencia: '', detalhe: '' }; 
        if(h === 'FELIZ') ir('motivo_feliz');
        else if(h === 'NORMAL') finalizarCriança('Dia normal');
        else ir('motivo_triste');
    }

    function setOcorrencia(o, p) { relatoCriança.ocorrencia += (relatoCriança.ocorrencia ? " > " : "") + o; ir(p); }
    function setAgente(a) { relatoCriança.detalhe = "Quem: " + a; ir('tela_corpo'); }

    function finalizarCriança(d) {
        if (relatoCriança.detalhe) relatoCriança.detalhe += " | Relato: " + d;
        else relatoCriança.detalhe = d;
        let obs = JSON.parse(localStorage.getItem('tt_obs')) || [];
        obs.push({
            paiCpf: userLogado.cpf, // Chave de vínculo
            data: new Date().toLocaleString(),
            tipo: 'CRIANÇA',
            humor: relatoCriança.humor,
            ocorrencia: relatoCriança.ocorrencia || 'OK',
            detalhe: relatoCriança.detalhe
        });
        localStorage.setItem('tt_obs', JSON.stringify(obs));
        alert("Enviado!"); mostrarRelatorioIntegrado(); ir('painel_pais');
    }

    function mostrarRelatorioIntegrado() {
        let todas = JSON.parse(localStorage.getItem('tt_obs')) || [];
        let minhas = todas.filter(o => o.paiCpf === userLogado.cpf);
        document.getElementById('historico_integrado').innerHTML = minhas.reverse().map(o => `
            <div class="card-relatorio" style="border-left-color: ${o.tipo === 'CRIANÇA' ? 'var(--child)' : 'var(--primary)'}">
                <small><strong>${o.data}</strong> - ${o.tipo}</small><br>
                ${o.tipo === 'CRIANÇA' ? `Humor: ${o.humor} | Relato: ${o.ocorrencia} | ${o.detalhe}` : 
                `<strong>Prof(a) ${o.prof}:</strong> Visão: ${o.visual} | Social: ${o.isolamento} | Fala: ${o.fala}`}
            </div>
        `).join('') || "Sem dados.";
    }

    function acessarAdmin() {
        if(document.getElementById('admin_key').value === '123') {
            ir('painel_admin');
            const pais = JSON.parse(localStorage.getItem('tt_pais')) || [];
            const profs = JSON.parse(localStorage.getItem('tt_profs')) || [];
            document.getElementById('tabela_admin_body').innerHTML = 
                pais.map(p => `<tr><td>PAI</td><td>${p.nome}</td><td>${p.codigoVinc}</td></tr>`).join('') +
                profs.map(pr => `<tr><td>PROF</td><td>${pr.nome}</td><td>${pr.codigoVinc}</td></tr>`).join('');
        } else alert("Senha incorreta");
    }
</script>
</body>
</html>
